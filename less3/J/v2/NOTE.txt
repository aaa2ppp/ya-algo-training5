Аллокации тратим на сортировке при ранжировании частей в doRound,
Основное время тратим во вложенном цикле O(K*N) поска хостов источников для каждой части, затем сортировка...